generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Usuario {
  id          String   @id @default(uuid())
  email       String   @unique    // ADICIONE ISTO AQUI
  senhaHash   String
  vbucks      Int      @default(10000)
  createdAt   DateTime @default(now())
  itensComprados ItemComprado[]
  historico HistoricoTransacao[]

}


model Cosmetico {
  id          String               @id @default(uuid())
  apiId       String               @unique
  nome        String
  tipo        String?
  raridade    String?
  imagemUrl   String?
  preco       Int?
  isNew       Boolean              @default(false)
  isForSale   Boolean              @default(false)
  isPromo     Boolean              @default(false)
  addedAt     DateTime
  compradoPor ItemComprado[]
  historico   HistoricoTransacao[] 
}

model ItemComprado {
  id          String    @id @default(uuid())
  usuarioId   String
  cosmeticoId String
  dataCompra  DateTime  @default(now())
  cosmetico   Cosmetico @relation(fields: [cosmeticoId], references: [id])
  usuario     Usuario   @relation(fields: [usuarioId], references: [id])

  @@unique([usuarioId, cosmeticoId])
}

model HistoricoTransacao {
  id             String    @id @default(uuid())
  usuarioId      String
  cosmeticoId    String?
  tipo           String
  valorVbucks    Int       
  data           DateTime  @default(now())

  usuario        Usuario   @relation(fields: [usuarioId], references: [id])
  cosmetico      Cosmetico? @relation(fields: [cosmeticoId], references: [id])
}